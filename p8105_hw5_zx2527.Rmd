---
title: "p8105_hw5_zx2527"
author: "Zihan Xiong"
date: "2025-11-14"
output: github_document
---
# Problem 1

```{r}
library(tidyverse)
```


```{r}
bday_sim=function(n_room) {
  birthdays=sample(1:365, n_room, replace = TRUE)
  repeated_bday=length(unique(birthdays)) < n_room
  return(repeated_bday)
}
```
## check duplications
```{r}
bday_sim(20)
```
Yes, there are duplications. 

```{r}
bday_sim_results=
  expand_grid(
    bdays=2:50,
    iter=1:10000
  ) |>
  mutate(
    results=map_lgl(bdays, bday_sim))|>
      group_by(bdays) |>
  summarise(
    prob_repeat=mean(results)
  )
```

```{r}
n_list= 2:50
probabilities=
  tibble(
    n=n_list,
    prob=map_dbl(n_list, replicate_one_n)
  )
probabilities
```

```{r}
probabilities |>
  ggplot(aes(x=n, y=prob))+
  geom_line()+
  geom_point()+
  labs(
    title="Probability of Shared Birthdays vs Group Size",
    x="Group Size (n)",
    y="Probability"
  )
ggsave("birthday vs group size.png", width=8, height=6, dpi=300)
```
The plot shows the estimated probability of at least two people shared the same birthday as the group size increases from 2 to 50. The probability increases as the group size is increasing, indicates that when the group is small, the probability of at least 2 people shared the same birthday is close to 0, while the probability increases sharply as the group size grows.

# Problem 2

